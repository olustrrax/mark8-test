{"ast":null,"code":"import \"antd/lib/card/style\";\nimport _Card from \"antd/lib/card\";\nimport \"antd/lib/button/style\";\nimport _Button from \"antd/lib/button\";\nimport _taggedTemplateLiteral from \"@babel/runtime/helpers/esm/taggedTemplateLiteral\";\nimport \"antd/lib/row/style\";\nimport _Row from \"antd/lib/row\";\nimport \"antd/lib/upload/style\";\nimport _Upload from \"antd/lib/upload\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport \"antd/lib/layout/style\";\nimport _Layout from \"antd/lib/layout\";\n\nvar _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\n\nfunction _templateObject7() {\n  var data = _taggedTemplateLiteral([\"\\n  position: absolute;\\n  width: 90px;\\n  height: 31.76px;\\n  left: 20vw;\\n  top: 12.18px;\\n\"]);\n\n  _templateObject7 = function _templateObject7() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject6() {\n  var data = _taggedTemplateLiteral([\"\\n  width: 100%;\\n  height: 56px;\\n  background: #002240;\\n  position: absolute;\\n  left: 0px;\\n  top: 0px;\\n\"]);\n\n  _templateObject6 = function _templateObject6() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject5() {\n  var data = _taggedTemplateLiteral([\"\\n  min-height: 10vh;\\n  margin-top: 120px;\\n  padding: 0 20vw;\\n\"]);\n\n  _templateObject5 = function _templateObject5() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject4() {\n  var data = _taggedTemplateLiteral([\"\\n  max-width: 1019px;\\n  height: 296px;\\n  margin: auto;\\n  /* bg card */\\n\\n  background: #FFFFFF;\\n  /* Border */\\n\\n  border: 1px solid #E5E5E5;\\n  box-sizing: border-box;\\n  border-radius: 6px;\\n  .ant-card-body {\\n    padding: 20px 24px;\\n  }\\n\"]);\n\n  _templateObject4 = function _templateObject4() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject3() {\n  var data = _taggedTemplateLiteral([\"\\n  width: auto;\\n  height: auto;\\n  top: 0px;\\n  margin: 2vw 0;\\n  /* bg card */\\n\\n  background: #FFFFFF;\\n  /* Border */\\n\\n  border: 0.5px solid #E5E5E5;\\n  box-sizing: border-box;\\n\"]);\n\n  _templateObject3 = function _templateObject3() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject2() {\n  var data = _taggedTemplateLiteral([\"\\n  width: 30vw;\\n  height: 104px;\\n  left: 0px;\\n\\n  /* bg card */\\n\\n  background: #FFFFFF;\\n  /* Border */\\n  display: flex;\\n  border: 1px solid #E5E5E5;\\n  box-sizing: border-box;\\n  border-radius: 6px;\\n\"]);\n\n  _templateObject2 = function _templateObject2() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteral([\"\\n  display: flex;\\n  width: auto;\\n  height: 88px;\\n  left: 0px;\\n  top: 0px;\\n\\n  /* bg card */\\n\\n  background: #FFFFFF;\\n  /* Border */\\n\\n  border: 0.5px solid #E5E5E5;\\n  box-sizing: border-box;\\n  div.box{\\n    background: #F3F5F8;\\n    height: 88px;\\n    display: flex;\\n  }\\n  p.update{\\n    color: #0089FF;\\n    margin: auto 1vw;\\n    line-height: 0;\\n  }\\n  h2{\\n    margin: auto 2vw;\\n  }\\n  h2.list{\\n    width: 70%;\\n  }\\n\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it; if (typeof Symbol === \"undefined\" || o[Symbol.iterator] == null) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = o[Symbol.iterator](); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it[\"return\"] != null) it[\"return\"](); } finally { if (didErr) throw err; } } }; }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nimport React from \"react\";\nimport { InboxOutlined, ExclamationCircleFilled } from '@ant-design/icons';\nvar Header = _Layout.Header;\nimport { useState } from 'react';\nimport TableData from \"../components/TableData\";\nimport styled from \"styled-components\";\nimport axios from 'axios';\n\nvar csvToArray = function csvToArray(text) {\n  var row = [],\n      c = 0,\n      i = 0,\n      ans = '',\n      res = [];\n\n  var _iterator = _createForOfIteratorHelper(text),\n      _step;\n\n  try {\n    for (_iterator.s(); !(_step = _iterator.n()).done;) {\n      var d = _step.value;\n\n      if (d === ',' && !c) {\n        row.push(ans);\n        ans = d = '';\n      } else if (d === '\"') {\n        if (!c) c = 1;else c = 0;\n        d = '';\n      } else if ((++i === text.length || '\\n' === d || '\\r' === d) && !c && row.length) {\n        row.push(ans);\n        res.push(row);\n        d = ans = '';\n        row = [];\n        c = 0;\n      }\n\n      ans += d;\n    }\n  } catch (err) {\n    _iterator.e(err);\n  } finally {\n    _iterator.f();\n  }\n\n  res.push(row);\n  return res;\n};\n\nvar Home = function Home() {\n  _s();\n\n  var title = \"Bulk Upload form\";\n\n  var _useState = useState([]),\n      dataPost = _useState[0],\n      setDataPost = _useState[1];\n\n  var _useState2 = useState(),\n      amountSuccess = _useState2[0],\n      setASuccess = _useState2[1];\n\n  var _useState3 = useState(\"\"),\n      dataInvalid = _useState3[0],\n      setDataInvalid = _useState3[1];\n\n  var ConvertData = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(csv) {\n      var dataArray, headers, result, success;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return csvToArray(csv);\n\n            case 2:\n              dataArray = _context.sent;\n              headers = dataArray[0];\n              result = dataArray.slice(1).reduce(function (o, row, i) {\n                var fields = row;\n                var mapData = {\n                  amenity: [],\n                  status: []\n                };\n                headers.map(function (name, j) {\n                  if (['agent_post', 'accept_agent'].includes(name)) {\n                    if (fields[j] === \"TRUE\") {\n                      mapData.status.push(name);\n                    }\n                  } else if (j < 13) {\n                    mapData[name] = fields[j] || \"not found\";\n                    if (!fields[j] && !mapData.id.match('error')) mapData.id += 'error';\n                  } else {\n                    if (fields[j]) {\n                      mapData.amenity.push(name);\n                    }\n                  }\n                });\n                o.push(mapData);\n                return o;\n              }, []);\n              success = result.filter(function (e) {\n                var _e$id;\n\n                return !((_e$id = e.id) === null || _e$id === void 0 ? void 0 : _e$id.match('error'));\n              });\n              setASuccess((success === null || success === void 0 ? void 0 : success.length) || 0);\n              setDataPost(result);\n              if ((success === null || success === void 0 ? void 0 : success.length) !== result.length) setDataInvalid(\"You haven’t upload any bulk data yet\");else setDataInvalid(\"\");\n\n            case 9:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function ConvertData(_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var onEditPhoto = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(event, id) {\n      var formData, file, newImg;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              formData = new FormData();\n              file = event.target.files[0];\n              formData.append('photo1', file);\n              _context2.next = 5;\n              return axios.post(\"/upload\", formData, {\n                headers: {\n                  \"Content-type\": \"multipart/form-data\"\n                }\n              }).then(function (res) {\n                return res === null || res === void 0 ? void 0 : res.data;\n              });\n\n            case 5:\n              newImg = _context2.sent;\n              _context2.next = 8;\n              return dataPost.map(function (e) {\n                if (e.id == id) {\n                  e.photo1 = newImg;\n                }\n\n                return e;\n              });\n\n            case 8:\n              dataPost = _context2.sent;\n              setDataPost(dataPost);\n\n            case 10:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function onEditPhoto(_x2, _x3) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  return __jsx(React.Fragment, null, __jsx(Container, null, __jsx(HeaderSyle, null, __jsx(Logo, {\n    src: \"/icons/logo.png\"\n  })), __jsx(Box, {\n    title: __jsx(React.Fragment, null, __jsx(\"h2\", null, title, \" \", dataInvalid ? __jsx(ExclamationCircleFilled, {\n      style: {\n        fontSize: '20px',\n        color: \"#0089FF\"\n      }\n    }) : \"\"), __jsx(\"p\", {\n      style: {\n        color: \"#0089FF\",\n        margin: 0\n      }\n    }, dataInvalid))\n  }, __jsx(\"h2\", null, \"Choose your an input medthod\"), __jsx(_Upload, {\n    accept: \".csv\",\n    showUploadList: false,\n    beforeUpload: function beforeUpload(file) {\n      var reader = new FileReader();\n\n      reader.onload = function (e) {\n        ConvertData(e.target.result);\n      };\n\n      reader.readAsText(file); // Prevent upload\n\n      return false;\n    }\n  }, __jsx(ButtonUpload, null, __jsx(\"img\", {\n    style: {\n      margin: \"auto 0\"\n    },\n    src: \"/icons/space_bar.png\"\n  }), __jsx(\"div\", {\n    style: {\n      width: \"100%\",\n      margin: \"auto 0 auto 1vw\",\n      textAlign: \"start\"\n    }\n  }, __jsx(\"p\", {\n    style: {\n      fontWeight: 800\n    }\n  }, \"via CSV file\"), __jsx(\"p\", null, \"\\u0E2D\\u0E31\\u0E1B\\u0E40\\u0E14\\u0E15\\u0E02\\u0E49\\u0E2D\\u0E21\\u0E39\\u0E25\\u0E08\\u0E32\\u0E01\\u0E44\\u0E1F\\u0E25\\u0E4C CSV\")))))), dataPost.length ? __jsx(ContentStyle, null, __jsx(ResultUpload, null, __jsx(\"div\", {\n    className: \"box\"\n  }, __jsx(\"h2\", null, amountSuccess)), __jsx(\"h2\", {\n    className: \"list\"\n  }, \"listings successfully and Ready to published\"), __jsx(_Row, {\n    display: \"flex\",\n    justifycontent: \"flex-end\"\n  }, __jsx(\"div\", {\n    style: {\n      margin: \"auto\",\n      display: \"flex\"\n    }\n  }, __jsx(\"img\", {\n    src: \"/icons/update.png\"\n  }), \" \", __jsx(\"p\", {\n    className: \"update\"\n  }, \"Update data\")), __jsx(\"div\", {\n    style: {\n      margin: \"auto 2vw\"\n    }\n  }, __jsx(\"img\", {\n    src: \"/icons/open_in_browser.png\"\n  })), __jsx(\"div\", {\n    style: {\n      margin: \"auto\"\n    }\n  }, __jsx(\"p\", {\n    style: {\n      margin: \"auto 1vw\",\n      color: \"#A6AAB4\"\n    }\n  }, \"Published\")))), __jsx(TableData, {\n    editPhoto: onEditPhoto,\n    rows: dataPost\n  })) : \"\");\n};\n\n_s(Home, \"9+WzWSFP9TUfk8Fjl4dImgN+SBk=\");\n\n_c = Home;\nexport default Home;\nvar ResultUpload = styled.div(_templateObject());\n_c2 = ResultUpload;\nvar ButtonUpload = styled(_Button)(_templateObject2());\n_c3 = ButtonUpload;\nvar ContentStyle = styled.div(_templateObject3());\n_c4 = ContentStyle;\nvar Box = styled(_Card)(_templateObject4());\n_c5 = Box;\nvar Container = styled.div(_templateObject5());\n_c6 = Container;\nvar HeaderSyle = styled(Header)(_templateObject6());\n_c7 = HeaderSyle;\nvar Logo = styled.img(_templateObject7());\n_c8 = Logo;\n\nvar _c, _c2, _c3, _c4, _c5, _c6, _c7, _c8;\n\n$RefreshReg$(_c, \"Home\");\n$RefreshReg$(_c2, \"ResultUpload\");\n$RefreshReg$(_c3, \"ButtonUpload\");\n$RefreshReg$(_c4, \"ContentStyle\");\n$RefreshReg$(_c5, \"Box\");\n$RefreshReg$(_c6, \"Container\");\n$RefreshReg$(_c7, \"HeaderSyle\");\n$RefreshReg$(_c8, \"Logo\");","map":{"version":3,"sources":["/Users/mookky/Documents/app/mark8-test/pages/index.js"],"names":["React","InboxOutlined","ExclamationCircleFilled","Header","useState","TableData","styled","axios","csvToArray","text","row","c","i","ans","res","d","push","length","Home","title","dataPost","setDataPost","amountSuccess","setASuccess","dataInvalid","setDataInvalid","ConvertData","csv","dataArray","headers","result","slice","reduce","o","fields","mapData","amenity","status","map","name","j","includes","id","match","success","filter","e","onEditPhoto","event","formData","FormData","file","target","files","append","post","then","data","newImg","photo1","fontSize","color","margin","reader","FileReader","onload","readAsText","width","textAlign","fontWeight","display","ResultUpload","div","ButtonUpload","ContentStyle","Box","Container","HeaderSyle","Logo","img"],"mappings":"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","sourcesContent":["import React from \"react\"\nimport { Layout, Card, Upload, Col, Button, Row } from \"antd\"\nimport { InboxOutlined,ExclamationCircleFilled } from '@ant-design/icons';\nconst { Header } = Layout\nimport { useState } from 'react'\nimport TableData from \"../components/TableData\"\nimport styled from \"styled-components\"\nimport axios from 'axios'\n\nconst csvToArray = (text) => {\n  let row = [], c = 0, i=0, ans = '', res = [];\n  for(let d of text){\n    if(d ===',' && !c){\n      row.push(ans)\n      ans = d = '';\n    }\n    else if(d==='\"'){\n      if(!c) c = 1; else c = 0;\n      d = '';\n    }\n    else if((++i === text.length || '\\n' === d || '\\r' === d ) && !c && row.length){\n      row.push(ans); res.push(row);\n      d = ans ='';\n      row = []; c = 0;\n    } \n    ans+=d;\n  }\n  res.push(row)\n  return res\n}\n\nconst Home = () => {\n  let title = `Bulk Upload form`\n  let [dataPost, setDataPost] = useState([])\n  const [amountSuccess, setASuccess] = useState()\n  const [dataInvalid, setDataInvalid] = useState(\"\")\n  const ConvertData = async (csv) => {\n    let dataArray = await csvToArray(csv);\n    let headers = dataArray[0]\n    const result = dataArray.slice(1).reduce((o, row, i) => {\n      const fields = row\n      let mapData = {\n        amenity: [],\n        status: [],\n      }\n      headers.map((name, j) => {\n        if(['agent_post','accept_agent'].includes(name)){\n          if(fields[j] === \"TRUE\"){\n            mapData.status.push(name)\n          }\n        }\n        else if(j < 13){\n          mapData[name] = fields[j] || \"not found\"\n          if(!fields[j] && !mapData.id.match('error')) mapData.id += 'error'\n        }\n        else{\n          if(fields[j]){\n            mapData.amenity.push(name)\n          }\n        }\n      })\n      o.push(mapData)\n      return o\n    },[])\n    const success = result.filter(e => !e.id?.match('error'))\n    setASuccess(success?.length || 0)\n    setDataPost(result)\n    if(success?.length !== result.length) setDataInvalid(\"You haven’t upload any bulk data yet\")\n    else setDataInvalid(\"\")\n  }\n\n  const onEditPhoto = async (event, id) => {\n    let formData = new FormData()\n    const file = event.target.files[0]\n    formData.append('photo1', file)\n    const newImg = await axios.post(\n      \"/upload\", \n      formData, \n      {\n        headers: {\n          \"Content-type\": \"multipart/form-data\",\n        }\n      }\n    )\n    .then((res) => {\n      return res?.data\n    })\n    dataPost = await dataPost.map((e) => { \n      if(e.id==id){ e.photo1 = newImg} \n      return e\n    })\n    setDataPost(dataPost)\n  }\n\n  return (\n    <>\n      <Container>\n        <HeaderSyle>\n          <Logo src=\"/icons/logo.png\" />\n        </HeaderSyle>\n        <Box title={\n          <>\n            <h2>{title} {dataInvalid? <ExclamationCircleFilled style={{ fontSize: '20px', color: \"#0089FF\"}} /> : \"\" }</h2>\n            <p style={{ color: \"#0089FF\", margin: 0}}>{dataInvalid}</p>\n          </>\n        }>\n          <h2>Choose your an input medthod</h2>\n          <Upload \n            accept=\".csv\"\n            showUploadList={false}\n            beforeUpload={file => {\n              const reader = new FileReader();\n              reader.onload = e => {\n                ConvertData(e.target.result)\n              };\n              reader.readAsText(file);\n              // Prevent upload\n              return false;\n            }}\n          >\n            <ButtonUpload>\n              <img style={{ margin: \"auto 0\"}} src=\"/icons/space_bar.png\"></img>\n              <div style={{ width: \"100%\", margin: \"auto 0 auto 1vw\", textAlign: \"start\"}}>\n                <p style={{ fontWeight: 800}} >via CSV file</p>\n                <p>\n                  อัปเดตข้อมูลจากไฟล์ CSV\n                </p>\n              </div>\n            </ButtonUpload>\n          </Upload>\n        </Box>\n      </Container>\n      {\n        dataPost.length ?\n        <ContentStyle>\n          <ResultUpload>\n            <div className=\"box\">\n              <h2>\n                {amountSuccess}\n              </h2>\n            </div>\n            <h2 className=\"list\">listings successfully and Ready to published</h2>\n            <Row display=\"flex\" justifycontent=\"flex-end\" >\n              <div style={{ margin: \"auto\", display: \"flex\"}} >\n                <img src=\"/icons/update.png\"/> <p className=\"update\">Update data</p>\n              </div>\n              <div style={{ margin: \"auto 2vw\"}}>\n                <img src=\"/icons/open_in_browser.png\" />\n              </div>\n              <div style={{ margin: \"auto\"}}>\n                <p style={{margin : \"auto 1vw\", color: \"#A6AAB4\"}}>Published</p>\n              </div>\n            </Row>\n          </ResultUpload>\n          <TableData\n            editPhoto={onEditPhoto}\n            rows={dataPost}\n          />\n        </ContentStyle>\n        : \"\"\n      }\n    </>\n  )\n}\n\nexport default Home\n\nconst ResultUpload = styled.div`\n  display: flex;\n  width: auto;\n  height: 88px;\n  left: 0px;\n  top: 0px;\n\n  /* bg card */\n\n  background: #FFFFFF;\n  /* Border */\n\n  border: 0.5px solid #E5E5E5;\n  box-sizing: border-box;\n  div.box{\n    background: #F3F5F8;\n    height: 88px;\n    display: flex;\n  }\n  p.update{\n    color: #0089FF;\n    margin: auto 1vw;\n    line-height: 0;\n  }\n  h2{\n    margin: auto 2vw;\n  }\n  h2.list{\n    width: 70%;\n  }\n`\nconst ButtonUpload = styled(Button)`\n  width: 30vw;\n  height: 104px;\n  left: 0px;\n\n  /* bg card */\n\n  background: #FFFFFF;\n  /* Border */\n  display: flex;\n  border: 1px solid #E5E5E5;\n  box-sizing: border-box;\n  border-radius: 6px;\n`\nconst ContentStyle = styled.div`\n  width: auto;\n  height: auto;\n  top: 0px;\n  margin: 2vw 0;\n  /* bg card */\n\n  background: #FFFFFF;\n  /* Border */\n\n  border: 0.5px solid #E5E5E5;\n  box-sizing: border-box;\n`\nconst Box = styled(Card)`\n  max-width: 1019px;\n  height: 296px;\n  margin: auto;\n  /* bg card */\n\n  background: #FFFFFF;\n  /* Border */\n\n  border: 1px solid #E5E5E5;\n  box-sizing: border-box;\n  border-radius: 6px;\n  .ant-card-body {\n    padding: 20px 24px;\n  }\n`\n\nconst Container = styled.div`\n  min-height: 10vh;\n  margin-top: 120px;\n  padding: 0 20vw;\n`\nconst HeaderSyle = styled(Header)`\n  width: 100%;\n  height: 56px;\n  background: #002240;\n  position: absolute;\n  left: 0px;\n  top: 0px;\n`\n\nconst Logo = styled.img`\n  position: absolute;\n  width: 90px;\n  height: 31.76px;\n  left: 20vw;\n  top: 12.18px;\n`\n"]},"metadata":{},"sourceType":"module"}